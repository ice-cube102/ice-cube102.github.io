<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>오늘의 명언</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap');
        body {
            font-family: 'Inter', sans-serif;
            transition: background-color 0.5s ease-in-out;
        }
        .captcha-container {
            position: relative;
            width: 320px;
            height: 120px;
            border: 1px solid #d1d5db;
            border-radius: 8px;
            overflow: hidden;
            background-color: #ffffff;
        }
        .captcha-text {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 2rem;
            font-weight: bold;
            letter-spacing: 2px;
            user-select: none;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.2);
            z-index: 10;
        }
        .line {
            position: absolute;
            height: 2px;
            background-color: rgba(0, 0, 0, 0.2);
            z-index: 5;
        }
    </style>
</head>
<body class="flex items-center justify-center min-h-screen bg-gray-100" id="main-body">
    <div class="bg-white p-8 rounded-xl shadow-lg w-full max-w-sm">
        <h1 class="text-2xl font-semibold text-center mb-6">오늘의 명언</h1>
        <p class="text-gray-600 text-center mb-6" id="main-description">아래 이미지의 문자를 대소문자 구분하여 입력하여 오늘의 명언을 받으세요.</p>
        
        <!-- CAPTCHA Section -->
        <div class="flex flex-col items-center mb-6">
            <div id="captcha-image-container" class="captcha-container flex items-center justify-center relative shadow-inner">
                <!-- Captcha will be generated here by JS -->
            </div>
            <p id="result-message" class="mt-4 text-sm font-medium"></p>
        </div>
        
        <!-- Input and Buttons -->
        <div class="space-y-4">
            <input type="text" id="captcha-input" class="w-full px-4 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500" placeholder="문자를 입력하세요.">
            <button id="check-button" class="w-full bg-blue-500 text-white font-semibold py-2 rounded-md hover:bg-blue-600 transition-colors">확인</button>
        </div>
        
        <!-- New section for the lucky code and quote -->
        <div id="result-info" class="mt-6 p-4 border-t-2 border-dashed border-gray-300 hidden">
            <p class="text-sm text-center text-gray-800 font-bold mb-2">확인되었습니다! 오늘의 행운을 잡으세요!</p>
            <div class="bg-gray-50 p-3 rounded-lg shadow-inner">
                <p class="text-xs text-gray-500">오늘의 명언:</p>
                <div class="flex items-center justify-between">
                    <p id="quote-of-the-day" class="text-sm italic text-gray-700 mt-1"></p>
                    <button id="copy-quote-button" class="px-2 py-1 bg-gray-200 text-gray-700 rounded-md text-xs hover:bg-gray-300">복사</button>
                </div>
            </div>
            <div class="bg-yellow-100 p-3 rounded-lg shadow mt-3">
                <p class="text-xs text-yellow-700">오늘의 행운의 코드:</p>
                <div class="flex items-center justify-between">
                    <p id="lucky-code" class="text-lg font-bold text-yellow-900 mt-1"></p>
                    <button id="copy-lucky-code-button" class="px-2 py-1 bg-gray-200 text-gray-700 rounded-md text-xs hover:bg-gray-300">복사</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Global variables and constants
        const captchaImageContainer = document.getElementById('captcha-image-container');
        const captchaInput = document.getElementById('captcha-input');
        const checkButton = document.getElementById('check-button');
        const resultMessage = document.getElementById('result-message');
        const resultInfo = document.getElementById('result-info');
        const quoteEl = document.getElementById('quote-of-the-day');
        const luckyCodeEl = document.getElementById('lucky-code');
        const mainBody = document.getElementById('main-body');
        const copyQuoteButton = document.getElementById('copy-quote-button');
        const copyLuckyCodeButton = document.getElementById('copy-lucky-code-button');

        let correctCaptcha = '';
        const baseClasses = 'flex items-center justify-center min-h-screen transition-colors duration-500';
        const backgroundColors = [
            'bg-gray-100',
            'bg-green-100',
            'bg-blue-100',
            'bg-purple-100',
            'bg-gradient-to-r from-pink-400 to-purple-500',
            'bg-gradient-to-r from-blue-600 to-green-400',
            'bg-gradient-to-r from-cyan-500 to-blue-500'
        ];

        const quotes = [
            "시작이 반이다.",
            "하루를 충실하게 살면 한 달이 즐겁고, 한 달을 충실하게 살면 일 년이 즐겁고, 일 년을 충실하게 살면 평생이 즐겁다.",
            "성공은 넘어지는 횟수가 아니라 다시 일어서는 횟수다.",
            "포기하지 않는다면 아무것도 끝나지 않는다.",
            "가장 늦었다고 생각했을 때가 가장 빠른 시작이다.",
            "인생은 용기다.",
            "위대한 정신을 가진 사람들은 목표를 가지고 있고, 그렇지 않은 사람들은 소원을 가지고 있다.",
            "배움은 깨어 있는 영혼의 즐거움이다.",
            "행복이란 무엇인가를 열심히 사랑하는 데 있다.",
            "미래는 현재 우리가 하는 일에 달려 있다.",
            "고난의 시기에 동요하지 않는 것이 진정 위대한 인물이다.",
            "가장 큰 위험은 위험 없는 삶이다.",
            "행복의 문이 하나 닫히면 다른 문이 열린다.",
            "자신을 믿어라. 그러면 어떻게 해야 할지 알게 될 것이다.",
            "태양을 바라보라. 그러면 그림자를 볼 수 없다.",
            "길이 막히면 다른 길을 찾아라.",
            "오늘 할 수 있는 일에 최선을 다하라. 내일은 그것을 완성할 시간이 없으므로.",
            "인생은 자전거를 타는 것과 같다. 균형을 잡으려면 계속 움직여야 한다.",
            "성공의 비결은 평생 동안 계속 배우는 것이다.",
            "용기란 두려움을 느끼지 않는 것이 아니라, 두려움에 맞서는 것이다.",
            "모든 일에는 때가 있고, 모든 소망을 이루는 데는 시간이 있다.",
            "우리가 무엇을 생각하든 우리는 그 자체이다.",
            "가장 어두운 밤에도 별은 빛난다.",
            "인내하는 마음은 모든 것을 이겨낼 수 있다.",
            "변화만이 영원한 것이다.",
            "강한 사람이 이기는 것이 아니라, 이기는 사람이 강한 것이다.",
            "행복은 준비된 마음의 것이다.",
            "최고의 복수는 성공이다.",
            "길이 아닌 곳은 길이 없고, 길이 있는 곳은 길이 아니다.",
            "말할 수 없는 고통을 견디는 것이 곧 용기다.",
            "시련은 있어도 실패는 없다.",
            "사람은 무엇을 배우든 그것을 믿게 된다.",
            "인생은 우리에게 가르쳐 주는 스승이다.",
            "사랑은 희생과 용기로부터 나온다."
        ];

        // Functions
        function generateRandomColor() {
            const r = Math.floor(Math.random() * 256);
            const g = Math.floor(Math.random() * 256);
            const b = Math.floor(Math.random() * 256);
            return `rgb(${r}, ${g}, ${b})`;
        }
        
        function generateCaptcha() {
            // 혼동하기 쉬운 문자와 숫자를 제거한 문자열
            const characters = 'ABCDEFGHJLMNQRSTVWZabcfghjmnqrstvwz123456789';
            let captcha = '';
            for (let i = 0; i < 6; i++) {
                captcha += characters.charAt(Math.floor(Math.random() * characters.length));
            }
            return captcha;
        }

        function renderCaptcha(text) {
            captchaImageContainer.innerHTML = '';
            
            for (let i = 0; i < 3; i++) {
                const line = document.createElement('div');
                line.className = 'line';
                line.style.top = `${Math.random() * 100}%`;
                line.style.left = `0`;
                line.style.width = `100%`;
                line.style.transform = `rotate(${Math.random() * 10 - 5}deg)`;
                line.style.backgroundColor = generateRandomColor();
                line.style.opacity = '0.5';
                captchaImageContainer.appendChild(line);
            }
            
            text.split('').forEach((char, index) => {
                const span = document.createElement('span');
                span.textContent = char;
                span.className = 'captcha-text';
                span.style.top = `${50 + (Math.random() * 20 - 10)}%`;
                span.style.left = `${10 + (index * 15) + (Math.random() * 5 - 2.5)}%`;
                span.style.transform = `rotate(${Math.random() * 30 - 15}deg)`;
                span.style.color = generateRandomColor();
                span.style.fontSize = `${2 + (Math.random() * 0.5 - 0.25)}rem`;
                captchaImageContainer.appendChild(span);
            });
        }

        function initCaptcha() {
            correctCaptcha = generateCaptcha();
            renderCaptcha(correctCaptcha);
            captchaInput.value = '';
            resultMessage.textContent = '';
            resultInfo.classList.add('hidden');
            captchaInput.disabled = false;
            checkButton.disabled = false;
        }
        
        function showTempMessage(message) {
            const messageContainer = document.createElement('div');
            messageContainer.textContent = message;
            messageContainer.className = 'fixed bottom-5 left-1/2 transform -translate-x-1/2 bg-gray-800 text-white px-4 py-2 rounded-lg opacity-0 transition-opacity duration-300';
            document.body.appendChild(messageContainer);

            setTimeout(() => {
                messageContainer.style.opacity = '1';
            }, 10);

            setTimeout(() => {
                messageContainer.style.opacity = '0';
                setTimeout(() => {
                    messageContainer.remove();
                }, 300);
            }, 2000);
        }

        function checkCaptcha() {
            const userInput = captchaInput.value;
            if (userInput === correctCaptcha) {
                resultMessage.textContent = '확인되었습니다!';
                resultMessage.className = 'mt-4 text-sm font-semibold text-green-600';
                
                // 배경색을 미리 정의된 목록에서 랜덤으로 변경
                const randomColor = backgroundColors[Math.floor(Math.random() * backgroundColors.length)];
                mainBody.className = `${baseClasses} ${randomColor}`;
                
                const randomQuote = quotes[Math.floor(Math.random() * quotes.length)];
                const now = new Date();
                const year = now.getFullYear();
                const month = now.getMonth() + 1;
                const day = now.getDate();
                const luckyCode = month * day * year;

                resultInfo.classList.remove('hidden');
                quoteEl.textContent = randomQuote;
                luckyCodeEl.textContent = luckyCode;
                captchaInput.disabled = true;
                checkButton.disabled = true;

            } else {
                resultMessage.textContent = '잘못된 코드입니다. 다시 시도하세요.';
                resultMessage.className = 'mt-4 text-sm font-semibold text-red-600';
                initCaptcha();
            }
        }

        window.onload = function() {
            initCaptcha();

            checkButton.addEventListener('click', checkCaptcha);
            
            captchaInput.addEventListener('keydown', (e) => {
                if (e.key === 'Enter') {
                    checkCaptcha();
                }
            });

            copyQuoteButton.addEventListener('click', () => {
                const textToCopy = quoteEl.textContent;
                if (textToCopy) {
                    navigator.clipboard.writeText(textToCopy).then(() => {
                        showTempMessage('명언이 복사되었습니다!');
                    }).catch(err => {
                        const tempInput = document.createElement('textarea');
                        tempInput.value = textToCopy;
                        document.body.appendChild(tempInput);
                        tempInput.select();
                        document.execCommand('copy');
                        document.body.removeChild(tempInput);
                        showTempMessage('명언이 복사되었습니다!');
                    });
                }
            });

            copyLuckyCodeButton.addEventListener('click', () => {
                const textToCopy = luckyCodeEl.textContent;
                if (textToCopy) {
                    navigator.clipboard.writeText(textToCopy).then(() => {
                        showTempMessage('행운의 코드가 복사되었습니다!');
                    }).catch(err => {
                        const tempInput = document.createElement('textarea');
                        tempInput.value = textToCopy;
                        document.body.appendChild(tempInput);
                        tempInput.select();
                        document.execCommand('copy');
                        document.body.removeChild(tempInput);
                        showTempMessage('행운의 코드가 복사되었습니다!');
                    });
                }
            });
        }
    </script>
</body>
</html>
